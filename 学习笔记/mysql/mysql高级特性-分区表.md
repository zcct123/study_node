# 分区表

分区表是一个独立的逻辑表，但是底层有多个物理子表组成。实现分区表的代码实际上是对一组底层表的句柄对象的封装。对分区表的请求，都会通过句柄对象转化成存储引擎的接口调用。 分区表对 sql 来说是一个完全封装实现的黑盒子，每一个分区表都有一个使用 # 分隔明明的表文件

mysql 实现分区表的方式——对底层表的封装——意味着索引也是按照分区的子表定义的，而没有全局索引

mysql在创建表时手机用 RARTITION BY 子句定义每一个分区存放的数据，在执行查询的时候，优化器会根据分区定义过滤那些没有我们需要数据的分区，这样查询就无需扫描所有分区。


分区表本身的限制
* 一个表最多有1024个分区、
* 在mysql5.1中分区表达式必须是整数，或者返回整数的表达式。在mysql5.5中某些长江可以直接使用列来进行分区。
* 如果分区字段中有著就按或者唯一索引的列，那么所有主键列和唯一索引列都必须包含进来
* 分区表无法使用外键约束

## 原理

1. select 查询

    当插叙一个分区表时，分区表线索住所有底层表，优化器判断是否可以过滤部分分区，然后调用对应的存储引擎接口访问各个分区的数据

2. insert操作

    当写入一条记录时，分区表先打开并所著所有底层表，然后定位哪个分区接收这条记录，在讲纪律写入对应的底层表

3. 